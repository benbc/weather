Typed "outputs" for pure runners of trace and writefile effects
Maybe use writer directly instead of interpreting trace/writeFile to lists?
Make the integration test less horrid
Maybe run full thing as a test?
